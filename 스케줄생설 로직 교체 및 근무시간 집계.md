- 하루 1인 1배정(권장): OFF 또는 아래 6개 중 1개
- 근무 유형(시작·종료 고정)

| 코드 | 유형      | 시간        | 휴게  |
| ---- | --------- | ----------- | ----- |
| O_F  | 오픈 풀   | 08:00–17:00 | 1시간 |
| O_H  | 오픈 하프 | 08:00–12:00 | 없음  |
| M_F  | 미들 풀   | 11:00–20:00 | 1시간 |
| M_H  | 미들 하프 | 11:00–15:00 | 없음  |
| C_F  | 마감 풀   | 12:30–21:30 | 1시간 |
| C_H  | 마감 하프 | 17:30–21:30 | 없음  |

하드 규칙(불만족 불가)

1. 헤드카운트 충족

- 날짜 d: 배정된 사람 수 = required_headcount[d]

2. 오픈/마감 커버

- 날짜 d: O_F 또는 O_H 배정자 수 ≥ 1
- 날짜 d: C_F 또는 C_H 배정자 수 ≥ 1

3. required_headcount[d] ≥ 3이면 O/M/C 각각 최소 1명

- O 블록: {O_F,O_H} ≥ 1
- M 블록: {M_F,M_H} ≥ 1
- C 블록: {C_F,C_H} ≥ 1
  (오픈/마감은 2)로 이미 강제이므로, 사실상 “required≥3 ⇒ 미들≥1”이 추가 핵심)

4. 개인별 가용/요청 반영

- OFF 요청: 그날 배정 금지
- half 요청: 그날 풀타임 금지(allowed_shifts[d]에서 \*\_F 제거)
- 기타 불가(예: 특정 요일 마감 불가 등)도 allowed_shifts[d]로 통일

필수 불가능 판정(먼저 체크)

- required_headcount[d] < 2 이면서 “오픈 1명 + 마감 1명”이 항상 필요하면 불가능
- 가용 인원 수 < required_headcount[d] 이면 불가능
- 오픈 가능 인원 = 0 또는 마감 가능 인원 = 0 이면 불가능
- required_headcount[d] ≥ 3인데 미들 가능 인원 = 0 이면 불가능

선호 처리(소프트 점수 없이, 그리디로만)
입력 형태(권장)

- preferred[e][d] = 1순위(또는 [1순위,2순위]) 예: “O”, “M”, “C”
- allowed_shifts[e][d] = {O_F,O_H,M_F,M_H,C_F,C_H} 중 가능한 집합

선호 충돌 해소 원칙(결정 규칙을 고정해야 결과가 일관됨)

- 같은 선호에 여러 명이 몰리면: “우선순위”로 1명만 선호 배정, 나머지는 남는 슬롯으로 이동
- 우선순위 : 최근 14일간 해당 블록 배정 횟수 적은 사람 우선

배정 알고리즘(하루 단위) 0) 후보 집합 만들기

- Avail = 그날 가용(OFF 아님)인 직원 목록

1. 필수 슬롯 먼저 확보(실패하면 불가능)

- 오픈 1명: Avail 중 O 가능자(allowed에 O_F 또는 O_H 포함)에서 선택

  - 우선: 선호가 O인 사람 → 그 외

- 마감 1명: Avail 중 C 가능자에서 선택

  - 우선: 선호가 C인 사람 → 그 외

- required≥3이면 미들 1명: Avail 중 M 가능자에서 선택

  - 우선: 선호가 M인 사람 → 그 외

- 선택 시 이미 뽑힌 사람 제외(하루 1인 1배정 기준)

2. 남은 헤드카운트 채우기(remaining = required - 현재배정인원)

- 남은 직원들에 대해, 각 직원의 선호 블록부터 시도

  - 선호 블록이 이미 “필수 최소”는 만족했더라도 추가 배정은 허용(규칙에 금지 없음)
  - 단, 특정 블록 과밀을 막고 싶으면 “상한”을 하드로 추가(예: 블록당 최대 X명)

- 선호 배정이 불가하면, allowed_shifts 내 아무거나 배정(우선순위 규칙으로 선택)

3. 하프/풀 선택 규칙(단순 고정)

- 직원이 half 요청이면 \*\_H 중에서만 선택
- 아니면 기본은 풀로 배정

# 근무시간 집계

- 스케줄 생성 후 “관리 페이지”에서 기간(시작일~종료일) 기준으로 직원별 총 근무시간을 조회한다.
- 특정 날짜에 “추가근무(수동)”를 입력하면 해당 직원의 근무시간 합계에 반영된다.

근무 타입(고정)

- O_F: 08:00–17:00, 휴게 1h, 유급근무 8h
- O_H: 08:00–12:00, 유급근무 4h
- M_F: 11:00–20:00, 휴게 1h, 유급근무 8h
- M_H: 11:00–15:00, 유급근무 4h
- C_F: 12:30–21:30, 휴게 1h, 유급근무 8h
- C_H: 17:30–21:30, 유급근무 4h
- OFF: 0h
  규칙: 하루 1인 1배정

요구 기능 2) 근무시간 집계(관리 페이지)
현재 스케줄 조회 페이지에 총 근무시간을 집계하여 추가

3. 추가근무 입력(관리 페이지)

- 날짜 선택 -> 직원 선택 -> 추가근무 시간입력
- 저장 시 해당 날짜/직원에 대한 “extra_work” 레코드로 누적 관리(삭제/수정 가능)
- 집계 시 기본 스케줄 시간 + extra_work 시간을 더한다.
- 유효성: 음수 금지, 24h 초과 금지
